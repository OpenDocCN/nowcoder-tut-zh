# 浩鲸科技 2020 届数据开发 A 卷

## 1

对于视图的描述错误的是:

正确答案: C   你的答案: 空 (错误)

```cpp
是一张虚拟的表
```

```cpp
在存储视图时存储的是视图的定义
```

```cpp
存储视图时，存储的是视图中的数据
```

```cpp
可以像查询表一样查询视图
```

本题知识点

大数据开发工程师 浩鲸云 2019 2020

讨论

[vector<>](https://www.nowcoder.com/profile/255171944)

 *   视图

    *   是虚拟存在的表，视图所对应的数据不进行实际的存储，数据库只存储视图的定义
    *   把一条 sql 的查询结果存放在一个视图里面，下次再查的时候，就不用走 sql 了，直接取走这个视图就行了 

发表于 2020-04-13 22:01:07

* * *

[锅菌鱼](https://www.nowcoder.com/profile/4342701)

视图是虚拟表，并不会保存数据

发表于 2020-04-02 01:30:02

* * *

[石开 123](https://www.nowcoder.com/profile/165192557)

视图（View）是从一个或多个表（或视图）导出的表。视图与表（有时为与视图区别，也称表为基本表——Base Table）不同，视图是一个虚表，即视图所对应的数据不进行实际存储，数据库中只存储视图的定义，在对视图的数据进行操作时，系统根据视图的定义去操作与视图相关联的基本表。

发表于 2020-02-25 23:35:28

* * *

## 2

下列哪项通常是集群的最主要瓶颈

正确答案: C   你的答案: 空 (错误)

```cpp
CPU
```

```cpp
网络
```

```cpp
磁盘 IO
```

```cpp
内存
```

本题知识点

大数据开发工程师 浩鲸云 2020

讨论

[夜间独白](https://www.nowcoder.com/profile/268480784)

不应该是网络吗，至少网络是集群计算的瓶颈。分布式计算才是核心，网络指的不是带宽，而是数据交换及同步状态监控等。说 io 也勉强可以吧

编辑于 2021-10-18 02:48:01

* * *

## 3

HIVE 中表的默认存储格式为：

正确答案: A   你的答案: 空 (错误)

```cpp
TextFile
```

```cpp
Avro
```

```cpp
SequenceFile
```

```cpp
RCFile
```

本题知识点

大数据开发工程师 浩鲸云 2019 2020

讨论

[牛客 2518 号](https://www.nowcoder.com/profile/715240518)

Hive 的文件存储格式： 1、textFile textFile 为默认格式 存储方式：行存储 缺点：磁盘开销大；数据解析开销大；压缩的 text 文件，hive 无法进行合并和拆分 2、sequencefile 二进制文件，以<key>的形式序列化到文件中存储方式：行存储 优点：可分割、压缩，一般选择 block 压缩，与 hadoop api 中的 mapfile 是互相兼容的。 3、 Rcfile 存储方式：数据按行分块 每块按照列存储 压缩快 快速列存取 读记录尽量涉及到的 block 最少 读取需要的列只需要读取每个 row group 的头部定义。 读取全量数据的操作 性能可能比 sequencefile 没有明显的优势 4、ORC(0.11 以后出现) 存储方式：数据按行分块 每块按照列存储 压缩快 快速列存取 效率比 rcfile 高，是 rcfile 的改良版本 5、 自定义格式 用户可以通过实现 inoutformat 和 outputformat 来定义输入输出格式。</key>

发表于 2020-03-20 06:39:58

* * *

## 4

把 ER 模型转换成关系模型的过程，属于数据库的

正确答案: C   你的答案: 空 (错误)

```cpp
需求分析
```

```cpp
概念设计
```

```cpp
逻辑设计
```

```cpp
物理设计
```

本题知识点

大数据开发工程师 浩鲸云 2020

讨论

[牛客 473694544 号](https://www.nowcoder.com/profile/473694544)

数据库设计通常分为 6 个阶段需求分析：分析用户的需求，包括数据、功能和性能需求；概念设计：主要采用 E-R 模型进行设计，包括画 E-R 图；逻辑设计：通过将 E-R 图转换成表，实现从 E-R 模型到关系模型的转换；物理设计：主要是为所设计的数据库选择合适的存储结构和存取路径；数据库的实施：包括编程、测试和试运行；数据库运行与维护：系统的运行与数据库的日常维护。

发表于 2021-06-15 11:11:56

* * *

## 5

在查询语句的 Where 子句中,如果出现了“age Between 30 and 40”,这个表达式等同于：

正确答案: A   你的答案: 空 (错误)

```cpp
age >= 30 and age <= 40
```

```cpp
age >= 30 or age <= 40
```

```cpp
age > 30 and age < 40
```

```cpp
age > 30 or age < 40
```

本题知识点

大数据开发工程师 浩鲸云 2020

## 6

对于数据仓库的特点下列说法中错误的是? 

正确答案: B   你的答案: 空 (错误)

```cpp
将来自多个数据源的数据进行整合
```

```cpp
数据仓库一般支撑数据实时更新和修改
```

```cpp
数据仓库通过 ETL 将数据进行清洗整合
```

本题知识点

大数据开发工程师 浩鲸云 2019 2020

讨论

[你永远得不到的祖奶奶](https://www.nowcoder.com/profile/855996890)

数据仓库就相当于是一个仓库，主要功能就是用来存储数据的，存储是最主要的目的，对于数据的实时改动，并不具备这样的功能。

发表于 2020-10-02 00:01:58

* * *

[游来游去](https://www.nowcoder.com/profile/497656)

数据仓库是为了便于多维分析和多角度展现而将数据按特定的模式进行存储所建立起来的关系型数据库，对多个异构的数据源有效集成，集成后按照主题进行了重组，并包含历史数据，而且存放在数据仓库中的数据一般不再修改。

编辑于 2020-03-01 18:18:22

* * *

[芋头稀饭](https://www.nowcoder.com/profile/967133833)

实时修改这个功能数据仓库不具备

发表于 2020-02-24 20:18:44

* * *

## 7

在 hadoop2.x 中，HDfS 中的 block 默认保存几份?默认大小为？

正确答案: A   你的答案: 空 (错误)

```cpp
3 份，128M
```

```cpp
2 份，64M
```

```cpp
1 份，64M
```

```cpp
不确定，无默认值
```

本题知识点

大数据开发工程师 浩鲸云 2019 2020

讨论

[Data 跳动](https://www.nowcoder.com/profile/754890807)

block 大小默认为 128M，和网络传输速率有关，其值一般认为是 100M/s。

发表于 2020-03-11 23:55:27

* * *

## 8

SQL 语言不包括以下哪些部分？

正确答案: D   你的答案: 空 (错误)

```cpp
DML
```

```cpp
DCL
```

```cpp
DDL
```

```cpp
DWL
```

本题知识点

大数据开发工程师 浩鲸云 2019 2020

讨论

[游来游去](https://www.nowcoder.com/profile/497656)

**DDL is Data Definition Language statements:**

    数据定义语言，用于定义和管理 SQL 数据库中的所有对象的语言。比如 create,alter,drop。

**DML is Data Manipulation Language statements:**

    数据操作语言，用于对数据进行处理的语言。比如 select,insert,update。

**DCL is Data Control Language statements. Some examples:**

    数据控制语言，用来授予或回收访问数据库的某种特权，并控制数据库操纵事务发生的时间及效果，对数据库实行监视等。比如 commit,rollback。

发表于 2020-03-01 18:01:35

* * *

[牛客 676665136 号](https://www.nowcoder.com/profile/676665136)

d

发表于 2020-11-06 20:50:11

* * *

[牛客 947620754 号](https://www.nowcoder.com/profile/947620754)

DDDL,DML,DCL,DQL

发表于 2020-07-06 19:31:21

* * *

## 9

按照“后进先出”原则组织数据的数据结构是

正确答案: B   你的答案: 空 (错误)

```cpp
队列
```

```cpp
栈
```

```cpp
二叉树
```

```cpp
双向链表
```

本题知识点

大数据开发工程师 浩鲸云 2020

## 10

术语“RAM”是指

正确答案: B   你的答案: 空 (错误)

```cpp
内存储器
```

```cpp
随机存储器存储
```

```cpp
只读存储器
```

```cpp
只读型
```

本题知识点

大数据开发工程师 浩鲸云 2020

讨论

[zb_real](https://www.nowcoder.com/profile/2594863)

RAM--随机存取存储器 ROM-只读存储器

发表于 2021-04-22 10:41:06

* * *

[牛客 569524875 号](https://www.nowcoder.com/profile/569524875)

RAM 一般指随机存取存储器。随机存取存储器（英语：Random Access Memory，缩写：RAM），也叫主存，是与 CPU 直接交换数据的内部存储器。它可以随时读写（刷新时除外），而且速度很快，通常作为操作系统或其他正在运行中的程序的临时数据存储介质

发表于 2021-04-13 12:35:44

* * *

## 11

谈谈你对 Hadoop 的认识

你的答案

本题知识点

大数据开发工程师 浩鲸云 2020

讨论

[牛客 359200119 号](https://www.nowcoder.com/profile/359200119)

Hadoop 是处理大数据的一套分布式框架，目前形成了一套生态体系。默认的 Hadoop 由 HDFS，MapReduce，Yarn 和辅助工具组成。HDFS 负责 Hadoop 大数据中的“存“功能，具有高容错（数据保存多个副本到不同节点），易扩展（可以方便的添加新节点）等优点 Map Reduce 负责”算“功能，是根据 Map－Reduce 理论实现的一套功能，总体上是把要计算的文件进行逻辑上的切分，然后分配到不同的节点进行计算，最后在 reduce 节点进行汇总。yarn 是框架的资源调度模组，分为两个模块，资源调度和任务管理，总的来说资源调度会根据用户设置的队列和资源调度模式自动分配任务到节点，任务管理会为每一个 job 生成一个 ApplicationMaster 去负责这个 job 中 mapTask，reduceTask 资源的申请，启动，以及失败后的重启。

发表于 2021-04-26 18:21:06

* * *

## 12

hive 内部表和外部表的区别？

你的答案

本题知识点

大数据开发工程师 阅文集团 2021 浩鲸云 2020

讨论

[零葬](https://www.nowcoder.com/profile/75718849)

未被 external 修饰的是内部表（managed table），被 external 修饰的为外部表（external table）；区别：
1.内部表数据由 Hive 自身管理，外部表数据由 HDFS 管理；
2.内部表数据存储的位置是 hive.metastore.warehouse.dir（默认：/user/hive/warehouse），外部表数据的存储位置由自己指定；
3.删除内部表会直接删除元数据（metadata）及存储数据；删除外部表仅仅会删除元数据，HDFS 上的文件并不会被删除；
4.对内部表的修改会将修改直接同步给元数据，而对外部表的表结构和分区进行修改，则需要修复（MSCK REPAIR TABLE table_name;）
5.Hive 创建内部表时，会将数据移动到数据仓库指向的路径；若创建外部表，仅记录数据所在的路径，不对数据的位置做任何改变。在删除表的时候，内部表的元数据和数据会被一起删除，而外部表只删除元数据，不删除数据。这样外部表相对来说更加安全些，数据组织也更加灵活，方便共享源数据。

发表于 2021-01-14 10:22:38

* * *

## 13

在 hive 中，什么情况下容易出现数据倾斜？如何解决？

你的答案

本题知识点

大数据开发工程师 浩鲸云 2019 2020

讨论

[枯荷听雨声](https://www.nowcoder.com/profile/1017833)

1.大表和小表联合的时候容易出现数据倾斜   使用 mapjoin  进小表装进内存中和大表进行联合 2.当某个字段是空值的时候   进行联合的时候判断非空 或者在 hive 的过程中对于空字段赋予一个随机值 3.当联合的字段数据类型不一样的时候  例如联合的字段是 int 和 String 类型的时候，由于 Hive 中 string 是转换为 int 来进行操作的，所以会有数据倾斜  进行联合的时候将 int 类型通过 cast(ziduan as string) 转换成 string 类型

发表于 2020-03-03 14:23:18

* * *

[BIGBOSS98](https://www.nowcoder.com/profile/807456481)

数据倾斜的原因：join,group by,count distinct 解决办法：1.多表关联时，将小表(关联键记录少的表)依次放到前面，这样可以触发 reduce 端更少的操作次数，减少运行时间。 2.同时可以使用 Map Join 让小的维度表缓存到内存。在 map 端完成 join 过程，从而省略掉 redcue 端的工作。但是使用这个功能，需要开启 map-side join 的设置属性：set hive.auto.convert.join=true(默认是 false)同时还可以设置使用这个优化的小表的大小：set hive.mapjoin.smalltable.filesize=25000000(默认值 25M)大表与大表关联，但是其中一张表的多是空值或者 0 比较多，容易 shuffle 给一个 reduce，造成运行慢 1.这种情况可以对异常值赋一个随机值来分散 key,均匀分配给多个 reduce 去执行 1.比如因 group by 造成数据倾斜？使用 Hive 对数据做一些类型统计的时候遇到过某种类型的数据量特别多，而其他类型数据的数据量特别少。当按照类型进行 group by 的时候，会将相同的 group by 字段的 reduce 任务需要的数据拉取到同一个节点进行聚合，而当其中每一组的数据量过大时，会出现其他组的计算已经完成而这里还没计算完成，其他节点的一直等待这个节点的任务执行完成，所以会看到一直 map 100%  reduce 99%的情况。解决方式 1：hive.map.aggr=true  （默认 true） 这个配置项代表是否在 map 端进行聚合，相当于 Combinerhive.groupby.skewindata=true（默认 false）有数据倾斜的时候进行负载均衡，当选项设定为 true，生成的查询计划会有两个 MR Job。第一个 MR Job 中，Map 的输出结果集合会随机分布到 Reduce 中，每个 Reduce 做部分聚合操作，并输出结果，这样处理的结果是相同的 Group By Key 有可能被分发到不同的 Reduce 中，从而达到负载均衡的目的；第二个 MR Job 再根据预处理的数据结果按照 Group By Key 分布到 Reduce 中（这个过程可以保证相同的 Group By Key 被分布到同一个 Reduce 中），最后完成最终的聚合操作  如果数据量非常大，执行如 select a,count(distinct b) from t group by a;类型的 SQL 时，会出现数据倾斜的问题。   解决方法：使用 sum...group by 代替。如 select a,sum(1) from (select a, b from t group by a,b) group by a;

发表于 2020-02-27 12:02:51

* * *

[牛客 312799627 号](https://www.nowcoder.com/profile/312799627)

一.1.本身数据就是倾斜的；2.业务操作导致的数据倾斜；二.数据倾斜的结局方案：1.group by 倾斜：a.map 端聚合；b.使用随机分区；c.数据倾斜自动负载均衡；2.join 时倾斜：a.提前过滤数据（分区、列裁剪等）、将大表变成多个小表，尽量在 map 端 join;                       b.Bucket join(reduce 阶段分桶、分区)；
                       c.Skew join(map 合 reduce 阶段配合使用 join)：                            for example:现在有两个地区：北京上海，原本数据在 1-2 倍正常范围内，现在双十二来临，上海又有别的地区没有的活动，上海地区的订单量直线增长为北京的 10 倍，这个时候叫不叫数据倾斜？如果是该怎么解决？现在把这些数据分成 10 份在 MAP 端进行处理，除此之外在 Reduce 端进行处理，这样就达到了 map 合 reduce 端配合使用的目的了；

发表于 2021-11-25 16:11:19

* * *

## 14

Oracle 有几种表关联方式？有何区别？

你的答案

本题知识点

大数据开发工程师 浩鲸云 2019 2020

讨论

[BIGBOSS98](https://www.nowcoder.com/profile/807456481)

oracle 中多表连接有很多种方式：
1、表与表连接有三种方式 Nested loop, Hash join, Sort merge join。
2、Nested Loop 就是循环嵌套的连接方法，对于被连接子集都是比较小的话，嵌套循环就是比较好的选择。在嵌套中，内表被外表驱动，外表做一次循环，内表针对外表的每一行做循环。
3、这种表的返回结果集不能太大，否则就效率实在太低的，而且还要用在表都有索引的情况下才行的。
4、Sort Merge Join 用在数据没有索引，并且数据必须是都排序号的情况。
5、总之，两表之间相连，会根据表之间的不同情况选择不同的连接方式，连接其实就是做表之间每行数据的遍历，连之前都要做好准备，有么用索引，要么用已排序号的表，要么就用 hash 算法，不存在什么都不准备的纯遍历循环。
6、三种连接使用前提，当表都排序号的话用 Sort Merge Join 连接，当两表都差不多大而且都还有索引就用 Nested Loop 的嵌套连接，当没有索引也没排序，而且数据量大的情况下就用这个 hash 算法进行相连。

发表于 2020-02-27 12:06:18

* * *