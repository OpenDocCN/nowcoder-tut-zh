# 浩鲸科技 2020 届数据开发类 C 卷

## 1

在存在下列关键字的 SQL 语句中,不可能出现 Where 子句的是

正确答案: D   你的答案: 空 (错误)

```cpp
Update
```

```cpp
Delete
```

```cpp
Insert
```

```cpp
Alter
```

本题知识点

大数据开发工程师 浩鲸云 2020

讨论

[牛客 72864520 号](https://www.nowcoder.com/profile/72864520)

Alter 是 DDL 语句，操作的是表的结构，并不会使用到 where

发表于 2021-08-18 14:13:31

* * *

## 2

数据库系统的数据独立性体现在

正确答案: B   你的答案: 空 (错误)

```cpp
不会因为数据的变化而影响到应用程序
```

```cpp
不会因为数据存储结构与数据逻辑结构的变化而影响应用程序
```

```cpp
不会因为存储策略的变化而影响存储结构
```

```cpp
不会因为某些存储结构的变化而影响其他的存储结构
```

本题知识点

大数据开发工程师 浩鲸云 2020

讨论

[牛客 _ 南方姑娘](https://www.nowcoder.com/profile/627680731)

数据独立性包括数据的物理独立性和数据的逻辑独立性。

物理独立性是指用户的应用程序与存储在磁盘上的数据库中数据是相互独立的。即，数据在磁盘上怎样存储由 DBMS(DataBase Management System 数据库管理系统)管理，用户程序不需要了解，应用程序要处理的只是数据的逻辑结构，这样当数据的物理存储改变了，应用程序不用改变。

逻辑独立性是指用户的应用程序与数据库的逻辑结构是相互独立的，即，当数据的逻辑结构改变时，用户程序也可以不变。

数据与程序的独立，把数据的定义从程序中分离出去，加上数据的存取又由 DBMS 负责，从而简化了应用程序的编制，大大减少了应用程序的维护和修改。

发表于 2021-05-12 23:20:26

* * *

## 3

只有满足连接条件的记录才会出现在查询结果中，这种连接为：

正确答案: C   你的答案: 空 (错误)

```cpp
左连接
```

```cpp
右连接
```

```cpp
内连接
```

```cpp
完全连接
```

本题知识点

大数据开发工程师 浩鲸云 2020

## 4

DELETE FROM S WHERE 年龄 > 60，语句的功能是：

正确答案: B   你的答案: 空 (错误)

```cpp
从 S 表中彻底删除年龄大于 60 的记录
```

```cpp
将 S 表中所以年龄大于 60 的记录打上删除标识
```

```cpp
删除表 S
```

```cpp
删除表 S 的年龄列
```

本题知识点

大数据开发工程师 浩鲸云 2020

## 5

SQL 的聚集函数 COUNT、SUM、AVG、MAX、MIN 不允许出现在查询语句的（）子句之中

正确答案: D   你的答案: 空 (错误)

```cpp
SELECT
```

```cpp
HAVING
```

```cpp
GROUP BY…HAVING
```

```cpp
WHERE
```

本题知识点

大数据开发工程师 浩鲸云 2020

## 6

对于数据集市，下列描述错误的是：

正确答案: A   你的答案: 空 (错误)

```cpp
数据仓库是数据集市的一个子集
```

```cpp
数据集市是为特定部门或特定应用目的而做的
```

```cpp
在数据仓库的实施过程中往往可以从一个部门的数据集市着手，以后再用几个数据集市组成一个完整的数据仓库。
```

```cpp
数据集市是从数据仓库中独立出来的一部分数据，也可称为部门数据或主题数据
```

本题知识点

大数据开发工程师 浩鲸云 2020

讨论

[牛客 _ 南方姑娘](https://www.nowcoder.com/profile/627680731)

数据集市可以分为两种

一种是独立数据集市(independent data mart)，这类数据集市有自己的源数据库和 ETL 架构；

一种是非独立数据集市(dependent data mart)，这种数据集市没有自己的源系统，它的数据来自数据仓库。

当用户或者应用程序不需要/不必要/不允许用到整个数据仓库的数据时，非独立数据集市就可以简单为用户提供一个数据仓库的"子集"。

发表于 2021-05-12 23:30:07

* * *

## 7

SQL 语言中，条件“年龄 BETWEEN 20 AND 30”表示年龄在 20 至 30 之间，且

正确答案: A   你的答案: 空 (错误)

```cpp
包括 20 岁和 30 岁
```

```cpp
不包括 20 岁和 30 岁
```

```cpp
包括 20 岁但不包括 30 岁
```

```cpp
包括 30 岁但不包括 20 岁
```

本题知识点

大数据开发工程师 浩鲸云 2020

## 8

Oracle 中下列哪个表达式值为 true:

正确答案: D   你的答案: 空 (错误)

```cpp
null = null
```

```cpp
‘’ = null
```

```cpp
0 = null
```

```cpp
以上三个都不为 true
```

本题知识点

大数据开发工程师 浩鲸云 2019 2020

讨论

[azhenpia](https://www.nowcoder.com/profile/757902564)

null 表示不可知不确定，null 不与任何值相等，包括 null 本身。要判断某个值是否为 null，使用 is NULL / is not NULL

发表于 2020-09-07 21:18:58

* * *

[牛客 560439462 号](https://www.nowcoder.com/profile/560439462)

D。 因为空值跟任何值进行关系运算，得到的结果都为不成立。

发表于 2020-10-28 11:54:09

* * *

## 9

在 E-R 图中,用来表示属性的图形是

正确答案: B   你的答案: 空 (错误)

```cpp
矩形
```

```cpp
椭圆形
```

```cpp
菱形
```

```cpp
三角形
```

本题知识点

大数据开发工程师 浩鲸云 2020

讨论

[80000 里](https://www.nowcoder.com/profile/919783409)

E-R 图包括实体，属性与关系，实体用矩形表示，属性用椭圆形表示，关系用菱形表示

发表于 2022-03-09 15:47:32

* * *

## 10

术语“ROM”是指( )

正确答案: C   你的答案: 空 (错误)

```cpp
内存储器
```

```cpp
随机存取存储器
```

```cpp
只读存储器
```

```cpp
只读型光盘存储器
```

本题知识点

大数据开发工程师 浩鲸云 2020

讨论

[牛客 472150684 号](https://www.nowcoder.com/profile/472150684)

RAM：随机存取存储器 ROM：只读存储器

发表于 2021-04-17 19:20:28

* * *

## 11

谈谈你对 Hadoop 的认识

你的答案

本题知识点

大数据开发工程师 浩鲸云 2020

讨论

[牛客 359200119 号](https://www.nowcoder.com/profile/359200119)

Hadoop 是处理大数据的一套分布式框架，目前形成了一套生态体系。默认的 Hadoop 由 HDFS，MapReduce，Yarn 和辅助工具组成。HDFS 负责 Hadoop 大数据中的“存“功能，具有高容错（数据保存多个副本到不同节点），易扩展（可以方便的添加新节点）等优点 Map Reduce 负责”算“功能，是根据 Map－Reduce 理论实现的一套功能，总体上是把要计算的文件进行逻辑上的切分，然后分配到不同的节点进行计算，最后在 reduce 节点进行汇总。yarn 是框架的资源调度模组，分为两个模块，资源调度和任务管理，总的来说资源调度会根据用户设置的队列和资源调度模式自动分配任务到节点，任务管理会为每一个 job 生成一个 ApplicationMaster 去负责这个 job 中 mapTask，reduceTask 资源的申请，启动，以及失败后的重启。

发表于 2021-04-26 18:21:06

* * *

## 12

在 hive 中，什么情况下容易出现数据倾斜？如何解决？

你的答案

本题知识点

大数据开发工程师 浩鲸云 2019 2020

讨论

[枯荷听雨声](https://www.nowcoder.com/profile/1017833)

1.大表和小表联合的时候容易出现数据倾斜   使用 mapjoin  进小表装进内存中和大表进行联合 2.当某个字段是空值的时候   进行联合的时候判断非空 或者在 hive 的过程中对于空字段赋予一个随机值 3.当联合的字段数据类型不一样的时候  例如联合的字段是 int 和 String 类型的时候，由于 Hive 中 string 是转换为 int 来进行操作的，所以会有数据倾斜  进行联合的时候将 int 类型通过 cast(ziduan as string) 转换成 string 类型

发表于 2020-03-03 14:23:18

* * *

[BIGBOSS98](https://www.nowcoder.com/profile/807456481)

数据倾斜的原因：join,group by,count distinct 解决办法：1.多表关联时，将小表(关联键记录少的表)依次放到前面，这样可以触发 reduce 端更少的操作次数，减少运行时间。 2.同时可以使用 Map Join 让小的维度表缓存到内存。在 map 端完成 join 过程，从而省略掉 redcue 端的工作。但是使用这个功能，需要开启 map-side join 的设置属性：set hive.auto.convert.join=true(默认是 false)同时还可以设置使用这个优化的小表的大小：set hive.mapjoin.smalltable.filesize=25000000(默认值 25M)大表与大表关联，但是其中一张表的多是空值或者 0 比较多，容易 shuffle 给一个 reduce，造成运行慢 1.这种情况可以对异常值赋一个随机值来分散 key,均匀分配给多个 reduce 去执行 1.比如因 group by 造成数据倾斜？使用 Hive 对数据做一些类型统计的时候遇到过某种类型的数据量特别多，而其他类型数据的数据量特别少。当按照类型进行 group by 的时候，会将相同的 group by 字段的 reduce 任务需要的数据拉取到同一个节点进行聚合，而当其中每一组的数据量过大时，会出现其他组的计算已经完成而这里还没计算完成，其他节点的一直等待这个节点的任务执行完成，所以会看到一直 map 100%  reduce 99%的情况。解决方式 1：hive.map.aggr=true  （默认 true） 这个配置项代表是否在 map 端进行聚合，相当于 Combinerhive.groupby.skewindata=true（默认 false）有数据倾斜的时候进行负载均衡，当选项设定为 true，生成的查询计划会有两个 MR Job。第一个 MR Job 中，Map 的输出结果集合会随机分布到 Reduce 中，每个 Reduce 做部分聚合操作，并输出结果，这样处理的结果是相同的 Group By Key 有可能被分发到不同的 Reduce 中，从而达到负载均衡的目的；第二个 MR Job 再根据预处理的数据结果按照 Group By Key 分布到 Reduce 中（这个过程可以保证相同的 Group By Key 被分布到同一个 Reduce 中），最后完成最终的聚合操作  如果数据量非常大，执行如 select a,count(distinct b) from t group by a;类型的 SQL 时，会出现数据倾斜的问题。   解决方法：使用 sum...group by 代替。如 select a,sum(1) from (select a, b from t group by a,b) group by a;

发表于 2020-02-27 12:02:51

* * *

[牛客 312799627 号](https://www.nowcoder.com/profile/312799627)

一.1.本身数据就是倾斜的；2.业务操作导致的数据倾斜；二.数据倾斜的结局方案：1.group by 倾斜：a.map 端聚合；b.使用随机分区；c.数据倾斜自动负载均衡；2.join 时倾斜：a.提前过滤数据（分区、列裁剪等）、将大表变成多个小表，尽量在 map 端 join;                       b.Bucket join(reduce 阶段分桶、分区)；
                       c.Skew join(map 合 reduce 阶段配合使用 join)：                            for example:现在有两个地区：北京上海，原本数据在 1-2 倍正常范围内，现在双十二来临，上海又有别的地区没有的活动，上海地区的订单量直线增长为北京的 10 倍，这个时候叫不叫数据倾斜？如果是该怎么解决？现在把这些数据分成 10 份在 MAP 端进行处理，除此之外在 Reduce 端进行处理，这样就达到了 map 合 reduce 端配合使用的目的了；

发表于 2021-11-25 16:11:19

* * *

## 13

Oracle 有几种表关联方式？有何区别？

你的答案

本题知识点

大数据开发工程师 浩鲸云 2019 2020

讨论

[BIGBOSS98](https://www.nowcoder.com/profile/807456481)

oracle 中多表连接有很多种方式：
1、表与表连接有三种方式 Nested loop, Hash join, Sort merge join。
2、Nested Loop 就是循环嵌套的连接方法，对于被连接子集都是比较小的话，嵌套循环就是比较好的选择。在嵌套中，内表被外表驱动，外表做一次循环，内表针对外表的每一行做循环。
3、这种表的返回结果集不能太大，否则就效率实在太低的，而且还要用在表都有索引的情况下才行的。
4、Sort Merge Join 用在数据没有索引，并且数据必须是都排序号的情况。
5、总之，两表之间相连，会根据表之间的不同情况选择不同的连接方式，连接其实就是做表之间每行数据的遍历，连之前都要做好准备，有么用索引，要么用已排序号的表，要么就用 hash 算法，不存在什么都不准备的纯遍历循环。
6、三种连接使用前提，当表都排序号的话用 Sort Merge Join 连接，当两表都差不多大而且都还有索引就用 Nested Loop 的嵌套连接，当没有索引也没排序，而且数据量大的情况下就用这个 hash 算法进行相连。

发表于 2020-02-27 12:06:18

* * *

## 14

请简单描述 HDFS 文件写入和文件读取的过程。

你的答案

本题知识点

大数据开发工程师 浩鲸云 2020