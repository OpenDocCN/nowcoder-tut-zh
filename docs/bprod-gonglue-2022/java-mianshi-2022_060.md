# 第七章 第 6 节 Java-计算机网络-6

> 原文：[`www.nowcoder.com/tutorial/10070/6884d90753c94ae4b2e8c51f4608d897`](https://www.nowcoder.com/tutorial/10070/6884d90753c94ae4b2e8c51f4608d897)

#### 1.27 说一说你对 IP 分类的了解。

**参考回答**

​ ![ip 分类](img/51a3d818f666376f2b242c9aac165898.png)

​ 五类互联网地址

​ IP 地址根据网络号和主机号来分，分为 A、B、C 三类及特殊地址 D、E。 全 0 和全 1 的都保留不用。

1.  A 类：(1.0.0.0-126.0.0.0)（默认子网掩码：255.0.0.0 或 0xFF000000）第一个字节为网络号，后三个字节为主机号。该类 IP 地址的最前面为“0”，所以地址的网络号取值于 1~126 之间。一般用于大型网络。
2.  B 类：(128.0.0.0-191.255.0.0)（默认子网掩码：255.255.0.0 或 0xFFFF0000）前两个字节为网络号，后两个字节为主机号。该类 IP 地址的最前面为“10”，所以地址的网络号取值于 128~191 之间。一般用于中等规模网络。
3.  C 类：(192.0.0.0-223.255.255.0)（子网掩码：255.255.255.0 或 0xFFFFFF00）前三个字节为网络号，最后一个字节为主机号。该类 IP 地址的最前面为“110”，所以地址的网络号取值于 192~223 之间。一般用于小型网络。
4.  D 类：是多播地址。该类 IP 地址的最前面为“1110”，所以地址的网络号取值于 224~239 之间。一般用于多路广播用户 。
5.  E 类：是保留地址。该类 IP 地址的最前面为“1111”，所以地址的网络号取值于 240~255 之间。

#### 1.28 IP 为什么要分类？

**参考回答**

​ 根据 IP 地址访问终端是通过路由器，路由设备当中有一张路由表，该路由表记录了所有 IP 地址的位置，这样就可以进行包的转发了，如果我们不区分网络地址，那么这张路由表当中就要保存有所有 IP 地址的方向，这张路由表就会很大，就像下面说的那样：如果不分网络位和主机位，路由器的路由表就是都是 32 位的地址，那所有的路由器维护的路由表会很大，转发速度会变慢（因为查询变慢）。而且所有的路由器都要有全 Internet 的地址，所有人的路由器都要有足够的性能来存下全网地址。估计建造这样的 Internet 成本是现在的几万倍，甚至更高。

​ **有了网络地址，就可以限定拥有相同网络地址的终端都在同一个范围内，那么路由表只需要维护这个网络地址的方向，就可以找到相应的终端了。**

#### 1.29 IPV4 和 IPV6 有什么区别？

**参考回答**

​ IPv4 和 IPv6 是是目前使用的两种 Internet 协议版本，IPv4 和 IPv6 协议之间存在各种差异，包括它们的功能，但关键的一点是它生成的地址（地址空间）的数量的区别。

1.  协议地址的区别

    （1）地址长度

    ​ IPv4 协议具有 32 位（4 字节）地址长度；IPv6 协议具有 128 位（16 字节）地址长度。

    （2）地址的表示方法

    ​ IPv4 地址是以小数表示的二进制数。 IPv6 地址是以十六进制表示的二进制数。

    （3）地址配置

    ​ IPv4 协议的地址可以通过手动或 DHCP 配置的。

    ​ IPv4 协议需要使用 Internet 控制消息协议版本 6（ICMPv6）或 DHCPv6 的无状态地址自动配置（SLAAC）。

2.  数据包的区别

    （1）包的大小

    ​ IPv4 协议的数据包需要 576 个字节，碎片可选 ；IPv6 协议的数据包需要 1280 个字节，不会碎片。

    （2）包头

    ​ IPv4 协议的包头的长度为 20 个字节，不识别用于 QoS 处理的数据包流，包含 checksum，包含最多 40 个字节的选项字段。

    ​ IPv6 协议的包头的长度为 40 个字节，包含指定 QoS 处理的数据包流的 Flow Label 字段，不包含 checksum；IPv6 协议没有字段，但 IPv6 扩展标头可用。

    （3）数据包碎片

    IPv4 协议的数据包碎片会由转发路由器和发送主机完成。IPv6 协议的数据包碎片仅由发送主机完成。

3.  DNS 记录

    IPv4 协议的地址（A）记录，映射主机名；指针（PTR）记录，IN-ADDR.ARPA DNS 域。

    IPv6 协议的地址（AAAA）记录，映射主机名；指针（PTR）记录，IP6.ARPA DNS 域

4.  IPSec 支持

    IPv4 协议的 IPSec 支持只是可选的；IPv6 协议有内置的 IPSec 支持。

5.  地址解析协议

    IPv4 协议：地址解析协议（ARP）可用于将 IPv4 地址映射到 MAC 地址。

    IPv6 协议：地址解析协议（ARP）被邻居发现协议（NDP）的功能所取代。

6.  身份验证和加密

    Pv6 提供身份验证和加密；但 IPv4 不提供。

**答案解析**

​ 无

#### 1.30 说一下 http 和 https 的区别。

**参考回答**

​ https 和 https 主要存在以下的区别：

1.  HTTPS 协议需要到 CA （Certificate Authority，证书颁发机构）申请证书，一般免费证书较少，因而需要一定费用。(以前的网易官网是 http，而网易邮箱是 https 。)
2.  HTTP 是超文本传输协议，信息是明文传输，HTTPS 则是具有安全性的 SSL 加密传输协议。
3.  HTTP 和 HTTPS 使用的是完全不同的连接方式，用的端口也不一样，前者是 80，后者是 443。
4.  HTTP 的连接很简单，是无状态的。HTTPS 协议是由 SSL+HTTP 协议构建的可进行加密传输、身份认证的网络协议，比 HTTP 协议安全。(无状态的意思是其数据包的发送、传输和接收都是相互独立的。无连接的意思是指通信双方都不长久的维持对方的任何信息。)

**答案解析**

1.  **超文本传输协议**（HTTP，HyperText Transfer Protocol）是互联网上应用最为广泛的一种网络协议。设计 HTTP 最初的目的是为了提供一种发布和接收 HTML 页面的方法。它可以使浏览器更加高效。HTTP 协议是以明文方式发送信息的，如果黑客截取了 Web 浏览器和服务器之间的传输报文，就可以直接获得其中的信息。

2.  **HTTP 原理**

    （1）客户端的浏览器首先要通过网络与服务器建立连接，该连接是通过 TCP 来完成的，一般 TCP 连接的端口号是 80。 建立连接后，客户机发送一个请求给服务器，请求方式的格式为：统一资源标识符（URL）、协议版本号，后边是 MIME 信息包括请求修饰符、客户机信息和许可内容。

    （2）服务器接到请求后，给予相应的响应信息，其格式为一个状态行，包括信息的协议版本号、一个成功或错误的代码，后边是 MIME 信息包括服务器信息、实体信息和可能的内容。

3.  **HTTPS**（Hyper Text Transfer Protocol over SecureSocket Layer）是以安全为目标的 HTTP 通道，是 HTTP 的安全版。HTTPS 的安全基础是 SSL。SSL 协议位于 TCP/IP 协议与各种应用层协议之间，为数据通讯提供安全支持。SSL 协议可分为两层：SSL 记录协议（SSL Record Protocol），它建立在可靠的传输协议（如 TCP）之上，为高层协议提供数据封装、压缩、加密等基本功能的支持。SSL 握手协议（SSL Handshake Protocol），它建立在 SSL 记录协议之上，用于在实际的数据传输开始前，通讯双方进行身份认证、协商加密算法、交换加密密钥等。

4.  **HTTPS 的工作原理**

    ​ 我们都知道 HTTPS 能够加密信息，以免敏感信息被第三方获取，所以很多银行网站或电子邮箱等等安全级别较高的服务都会采用 HTTPS 协议。

    ![HTTPS 工作原理](img/d191a64d73ed1ae2104e025d8ee2402c.png)

    客户端在使用 HTTPS 方式与 Web 服务器通信时有以下几个步骤，如图上图所示：

    （1）客户使用 https 的 URL 访问 Web 服务器，要求与 Web 服务器建立 SSL 连接。

    （2）Web 服务器收到客户端请求后，会将网站的证书信息（证书中包含公钥）传送一份给客户端。

    （3）客户端的浏览器与 Web 服务器开始协商 SSL 连接的安全等级，也就是信息加密的等级。

    （4）客户端的浏览器根据双方同意的安全等级，建立会话密钥，然后利用网站的公钥将会话密钥加密，并传送给网站。

    （5）Web 服务器利用自己的私钥解密出会话密钥。

    （6）Web 服务器利用会话密钥加密与客户端之间的通信。

5.  **HTTPS 的优点**

    尽管 HTTPS 并非绝对安全，掌握根证书的机构、掌握加密算法的组织同样可以进行中间人形式的攻击，但 HTTPS 仍是现行架构下最安全的解决方案，主要有以下几个好处：

    （1）使用 HTTPS 协议可认证用户和服务器，确保数据发送到正确的客户机和服务器；

    （2）HTTPS 协议是由 SSL+HTTP 协议构建的可进行加密传输、身份认证的网络协议，要比 http 协议安全，可防止数据在传输过程中不被窃取、改变，确保数据的完整性。

    （3）HTTPS 是现行架构下最安全的解决方案，虽然不是绝对安全，但它大幅增加了中间人攻击的成本。

    （4）谷歌曾在 2014 年 8 月份调整搜索引擎算法，并称“比起同等 HTTP 网站，采用 HTTPS 加密的网站在搜索结果中的排名将会更高”。

6.  **HTTPS 的缺点**

    ​ 虽然说 HTTPS 有很大的优势，但其相对来说，还是存在不足之处的：

    ​ （1）HTTPS 协议握手阶段比较费时，会使页面的加载时间延长近 50%，增加 10%到 20%的耗电；

    　（2）HTTPS 连接缓存不如 HTTP 高效，会增加数据开销和功耗，甚至已有的安全措施也会因此而受到影响；

    　（3）SSL 证书需要钱，功能越强大的证书费用越高，个人网站、小网站没有必要一般不会用。

    　（4）SSL 证书通常需要绑定 IP，不能在同一 IP 上绑定多个域名，IPv4 资源不可能支撑这个消耗。

    　（5）HTTPS 协议的加密范围也比较有限，在黑客攻击、拒绝服务攻击、服务器劫持等方面几乎起不到什么作用。最关键的，SSL 证书的信用链体系并不安全，特别是在某些国家可以控制 CA 根证书的情况下，中间人攻击一样可行。

#### 1.31 https 为什么采用混合加密机制？

**参考回答**

​ 一方面，第一阶段的非对称加密，保证了对称密钥的安全性；另一方面，第二阶段的对称加密，可以提高加密/解密处理的速度，提高数据传输的效率。

**答案解析**

1.  **为什么需要加密？**

    ​ 因为 http 的内容是明文传输的，明文数据会经过中间代理服务器、路由器、wifi 热点、通信服务运营商等多个物理节点，如果信息在传输过程中被劫持，传输的内容就完全暴露了，他还可以篡改传输的信息且不被双方察觉，这就是**中间人攻击**。所以我们才需要对信息进行加密。最简单容易理解的就是**对称加密**。

2.  **什么是对称加密？**

    ​ 就是有一个密钥，它可以对一段内容加密，加密后只能用它才能解密看到原本的内容，和我们日常生活中用的钥匙作用差不多。

3.  **用对称加密可行吗？**

    ​ **如果通信双方都各自持有同一个密钥，且没有别人知道，这两方的通信安全当然是可以被保证的（除非密钥被破解）。**然而最大的问题就是**这个密钥怎么让传输的双方知晓，同时不被别人知道**。如果由服务器生成一个密钥并传输给浏览器，那这个传输过程中密钥被别人劫持弄到手了怎么办？之后他就能用密钥解开双方传输的任何内容了，所以这么做当然不行。
    ​ 换种思路？试想一下，如果浏览器内部就预存了网站 A 的密钥，且可以确保除了浏览器和网站 A，不会有任何外人知道该密钥，那理论上用对称加密是可以的，这样浏览器只要预存好世界上所有 HTTPS 网站的密钥就行啦！这么做显然不现实。
    ​ 所以我们就需要神奇的**非对称加密**。

4.  **什么是非对称加密？**

    ​ 有两把密钥，通常一把叫做公钥、一把叫做私钥，用公钥加密的内容必须用私钥才能解开，同样，私钥加密的内容只有公钥能解开。

5.  **用非对称加密可行吗？**

    ```cpp
    鉴于非对称加密的机制，我们可能会有这种思路：服务器先把公钥直接明文传输给浏览器，之后浏览器向服务器传数据前都先用这个公钥加密好再传，这条数据的安全似乎可以保障了！**因为只有服务器有相应的私钥能解开这条数据**。
       然而**由服务器到浏览器的这条路怎么保障安全？**如果服务器用它的的私钥加密数据传给浏览器，那么浏览器用公钥可以解密它，而这个公钥是一开始通过明文传输给浏览器的，这个公钥被谁劫持到的话，他也能用该公钥解密服务器传来的信息了。所以**目前似乎只能保证由浏览器向服务器传输数据时的安全性**（其实仍有漏洞，下文会说）。
    ```

6.  **混合加密**

    ​ 非对称加密耗时，非对称加密+对称加密结合可以吗？而且得尽量减少非对称加密的次数。当然是可以的，而且非对称加密、解密各只需用一次即可。以下就是加密过程：

    （1）某网站拥有用于非对称加密的公钥 A、私钥 A’。

    （2）浏览器像网站服务器请求，服务器把公钥 A 明文给传输浏览器。

    （3）浏览器随机生成一个用于对称加密的密钥 X，用公钥 A 加密后传给服务器。

    （4）服务器拿到后用私钥 A’解密得到密钥 X。

    （5）这样双方就都拥有密钥 X 了，且别人无法知道它。之后双方所有数据都用密钥 X 加密解密。

    完美！HTTPS 基本就是采用了这种方案。