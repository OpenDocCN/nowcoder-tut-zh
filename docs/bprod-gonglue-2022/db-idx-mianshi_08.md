# 第三章 第 2 节 哈希索引和全文索引

> 原文：[`www.nowcoder.com/tutorial/10039/ed6a5823ad2f47dd85ce011134acb5c9`](https://www.nowcoder.com/tutorial/10039/ed6a5823ad2f47dd85ce011134acb5c9)

## 2.2 哈希索引

前面我们提到，利用辅助索引进行查找时，需要进行回表操作，回表就是根据主键到主键索引树又进行一次查找。如果某个辅助索引被频繁的利用到，则回表的次数很多，对查询的性能有很大的影响，能不能通过某些手段减少回表次数呢？

减少回表次数就是不通过主键，而是直接通过这个辅助索引直接找到完整的行数据。Innodb 存储引擎会监控对表上辅助索引的查找，如果发现某辅助索引被频繁访问，辅助索引成为热数据，会在该辅助索引的查询模式上建立哈希索引，从而减少回表次数，带来速度的提升。

![](img/95a10b0e480e688bbfddeb569bb3126d.png)

如图所示，正常的流程为：当根据辅助索引 index_col 时，先找到主键，然后利用主键在主键索引树上进行查找得到数据页。当 InnoDB 发现 index_col='x'被频繁的访问时，会自动建立一条索引，<index_col='x', 数据页位置>，下一次根据 index_col='x'查询时则可以利用到哈希索引，从而减少了回表。

值得一提的是，哈希索引的建立不是人为可控的，这些都是 InnoDB 引擎自动完成的。

## 2.3 全文索引

现在假设有这样一个需求，数据库表有 title 字段，需要查询所有包含 "政府" 的记录。如果用 like "%政府%"方式查询，查询速度慢，难以在超大规模数据中有效的返回。全文索引就是为这种场景设计的。

你可能没有注意过全文索引，不过至少应该对一种全文索引技术比较熟悉：各种的搜索引擎（通过关键词搜索文章）。虽然搜索引擎的索引对象是超大量的数据，并且通常其背后都不是关系型数据库，不过全文索引的基本原理是一样的。

全文索引，通过建立倒排索引，可以极大的提升检索效率，解决判断字段是否包含的问题。

倒排索引（英语：Inverted index），也常被称为反向索引、置入档案或反向档案，是一种索引方法，被用来存储在全文搜索下某个单词在一个文档或者一组文档中的存储位置的映射。它是文档检索系统中最常用的数据结构。

在 innoDB 存储引擎中，倒排索引存储的是：{单词，(单词所在文档的 ID,在文档中的具***置)}

例如有如下表：
![](img/9b806f19416d3629b09190e2b92ea996.png)
则在 Text 中创建全文索引，倒排索引如下：
![](img/146222357964146c13838732b3097500.png)