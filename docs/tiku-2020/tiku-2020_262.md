# 深信服校园招聘安全攻防 A 卷

## 1

谈谈在 WEB 类安全问题的应急处置过程中 web 日志溯源攻击路径的思路？

你的答案

本题知识点

安全工程师 深信服

讨论

[牛客 450640024 号](https://www.nowcoder.com/profile/450640024)

首先确定攻击时间，根据攻击时间，找出时段内的可疑日志，分析出可疑 ip，排查攻击特征，如漏洞扫描出会出现大量 404 和 sql 注入中出现 and 1=1 字样

发表于 2022-03-01 15:00:01

* * *

[“读你”](https://www.nowcoder.com/profile/7333168)

确定受到攻击的时间范围，查找可疑日志。其中含有大量的攻击信息，如可疑 IP， 具有特定的攻击特征，并且攻击者的 web 访问中还会出现 SQL 的漏洞注入，如 and 1=1 等字样，然后逆推，最终还原攻击过程。

发表于 2021-03-01 14:45:29

* * *

[牛客 935006236 号](https://www.nowcoder.com/profile/935006236)

根据受攻击的时间查找可疑日志，根据可疑 ip,攻击特征排查，如 sql 注入会出现一些 and 1=1 的字段，最终锁定目标，确认攻击手段，还原攻击过程。

发表于 2020-08-25 14:55:03

* * *

## 2

心脏滴血漏洞产生的原因，危害都有哪些？

你的答案

本题知识点

安全工程师 深信服

讨论

[三号矿场](https://www.nowcoder.com/profile/471576673)

产生原因：在实现 TLS 的心跳扩展时没有对输入进行适当验证，攻击者可以追踪 Open SSL 所分配的 64KB 缓存、将超出必要范围的字节信息复制到缓存当中然后再返回缓存内容。危害：攻击者可访问敏感数据，造成敏感数据泄露。还可能暴漏其他用户的敏感请求和响应。以及可以使特定版本下的 openssl 成为无需钥匙的废锁。

发表于 2022-03-02 13:33:53

* * *

[牛客 935006236 号](https://www.nowcoder.com/profile/935006236)

可以随机泄露内存中的 64k 数据，而且可通过重复读取获得更多内存数据，openssl 又是存储用户请求中的明文数据，其中包括源码，登录时用的明文账号密码，登录后服务器返回的合法认证因素，软件序列后，机密文件，甚至是可以突破一些系统保护机制的关键数据。还可能暴露其他用户的敏感请求和响应，包括用户任何形式的 POST 请求，会话 cookie 和密码，这使攻击者可以劫持其他用户的服务身份。

发表于 2020-08-25 15:23:15

* * *

## 3

Apache，IIS，Nginx 的文件解析漏洞都是如何解析和利用的？

你的答案

本题知识点

安全工程师 深信服

讨论

[牛客 281287070 号](https://www.nowcoder.com/profile/281287070)

感觉答案不够详细，有点生硬，可以再具体一点 Apache 解析漏洞

对 URL 从右往左逐层判断解析，不可解析就一直往左解析判断，直到能正确解析出文件

上传木马文件时，将合法后缀放在 URL 最右，绕过本地文件上传限制和服务器的类比黑名单验证
，Apache 服务器就会逐层从右往左解析，如 xx.php.jpg.rar 的一个木马文件最后会到 php 成功解析，那么
木马也就成功执行了。

IIS 解析漏洞

一种是 IIS5.x/6.0 解析漏洞

在网站下建立文件夹啊名称中带有.asp,.asa 等可执行的脚本文件后缀为后缀的文件夹，其目录内的任何扩展
名的文件都被当作可执行文件来解析

另外还有文件解析，IIS6.0 下分号后面的不解析，也就是 xx.asp;.jpg 被当成 xx.asp 来解析
除了 asp 还有.asa,.cer,.cdx 都可被解析

一种是 IIS7.0/IIS7.5 的畸形漏洞解析

在 Fast-CGI 开启下，会在例如 URL 为[`www.xxx.com/xx.jpg/.php`](http://www.xxx.com/xx.jpg/.php)中将 xx.jpg 当成 php 解析

Nginx 解析漏洞

在 Nginx0.5，0.6 以及 0.7 ⇐ 0.7.65，0.8 ⇐ 0.8.37 上存在空字节代码执行漏洞

也就是在访问如以下[`www.xxx.com/xx.jpg%00.php`](http://www.xxx.com/xx.jpg%00.php)中会将 xx.jpg 当作 php 文件解析
它将.jpg%00 看成一段字符

在 CVE-2013-4547 Nginx 下
还存在着将如下 URL [`www.xx.com/a.jpg%00`](http://www.xx.com/a.jpg%00)\0.php 中的 a.jpg 当作 php 执行漏洞

发表于 2020-08-05 19:16:18

* * *

[“读你”](https://www.nowcoder.com/profile/7333168)

Apache 解析漏洞，支持的后缀为“php”，并且在解析时是按照从右到左执行，如 12345.php.owf.rar,Apache 在解析时从右往左，解析成 12345.php 便解析完成，而攻击者可以把木马文件放在其中。IIS 解析漏洞，该网站下建立的文件夹名称后缀为.asp,.asa,其目录下的任何文件都被 IIS 当做 asp 文件来解析。 发表于 2021-03-01 14:58:26

* * *

[牛客 935006236 号](https://www.nowcoder.com/profile/935006236)

apache        从右向左依次解析后缀，直到遇到 php 才会解析成功 IIS5.X/6.0    网站下建立文件夹的名字为.asp、.asa 的文件夹，其目录内的任何扩展名的文件都被 IIS 当作 asp 文件来解析并执行。  ；号后不解析；还可解析.asa、.cer、.cdx 文件    IIS7.0/7.5 将.jpg 当作.php 解析
ngix     将.jpg 当作.php 文件解析

发表于 2020-08-25 16:15:32

* * *

## 4

从哪些方面可以进行 CSRF 漏洞防御？

你的答案

本题知识点

安全工程师 深信服

讨论

[Papillon-debug](https://www.nowcoder.com/profile/964364078)

5.对敏感的请求增加安全的 token，可以通过自定义 http 首部字段实现。

发表于 2020-05-26 16:48:21

* * *

[牛客 935006236 号](https://www.nowcoder.com/profile/935006236)

在请求地址中添加 token 并验证; 验证 http referer 字段；在 http 头中自定义属性并验证，加验证码，浏览器 cookie 策略，尽量使用 POST，限制使用 GET。

发表于 2020-08-25 16:32:28

* * *

## 1

谈谈在 WEB 类安全问题的应急处置过程中 web 日志溯源攻击路径的思路？

你的答案

本题知识点

安全工程师 深信服

讨论

[牛客 450640024 号](https://www.nowcoder.com/profile/450640024)

首先确定攻击时间，根据攻击时间，找出时段内的可疑日志，分析出可疑 ip，排查攻击特征，如漏洞扫描出会出现大量 404 和 sql 注入中出现 and 1=1 字样

发表于 2022-03-01 15:00:01

* * *

[“读你”](https://www.nowcoder.com/profile/7333168)

确定受到攻击的时间范围，查找可疑日志。其中含有大量的攻击信息，如可疑 IP， 具有特定的攻击特征，并且攻击者的 web 访问中还会出现 SQL 的漏洞注入，如 and 1=1 等字样，然后逆推，最终还原攻击过程。

发表于 2021-03-01 14:45:29

* * *

[牛客 935006236 号](https://www.nowcoder.com/profile/935006236)

根据受攻击的时间查找可疑日志，根据可疑 ip,攻击特征排查，如 sql 注入会出现一些 and 1=1 的字段，最终锁定目标，确认攻击手段，还原攻击过程。

发表于 2020-08-25 14:55:03

* * *

## 2

心脏滴血漏洞产生的原因，危害都有哪些？

你的答案

本题知识点

安全工程师 深信服

讨论

[三号矿场](https://www.nowcoder.com/profile/471576673)

产生原因：在实现 TLS 的心跳扩展时没有对输入进行适当验证，攻击者可以追踪 Open SSL 所分配的 64KB 缓存、将超出必要范围的字节信息复制到缓存当中然后再返回缓存内容。危害：攻击者可访问敏感数据，造成敏感数据泄露。还可能暴漏其他用户的敏感请求和响应。以及可以使特定版本下的 openssl 成为无需钥匙的废锁。

发表于 2022-03-02 13:33:53

* * *

[牛客 935006236 号](https://www.nowcoder.com/profile/935006236)

可以随机泄露内存中的 64k 数据，而且可通过重复读取获得更多内存数据，openssl 又是存储用户请求中的明文数据，其中包括源码，登录时用的明文账号密码，登录后服务器返回的合法认证因素，软件序列后，机密文件，甚至是可以突破一些系统保护机制的关键数据。还可能暴露其他用户的敏感请求和响应，包括用户任何形式的 POST 请求，会话 cookie 和密码，这使攻击者可以劫持其他用户的服务身份。

发表于 2020-08-25 15:23:15

* * *

## 3

Apache，IIS，Nginx 的文件解析漏洞都是如何解析和利用的？

你的答案

本题知识点

安全工程师 深信服

讨论

[牛客 281287070 号](https://www.nowcoder.com/profile/281287070)

感觉答案不够详细，有点生硬，可以再具体一点 Apache 解析漏洞

对 URL 从右往左逐层判断解析，不可解析就一直往左解析判断，直到能正确解析出文件

上传木马文件时，将合法后缀放在 URL 最右，绕过本地文件上传限制和服务器的类比黑名单验证
，Apache 服务器就会逐层从右往左解析，如 xx.php.jpg.rar 的一个木马文件最后会到 php 成功解析，那么
木马也就成功执行了。

IIS 解析漏洞

一种是 IIS5.x/6.0 解析漏洞

在网站下建立文件夹啊名称中带有.asp,.asa 等可执行的脚本文件后缀为后缀的文件夹，其目录内的任何扩展
名的文件都被当作可执行文件来解析

另外还有文件解析，IIS6.0 下分号后面的不解析，也就是 xx.asp;.jpg 被当成 xx.asp 来解析
除了 asp 还有.asa,.cer,.cdx 都可被解析

一种是 IIS7.0/IIS7.5 的畸形漏洞解析

在 Fast-CGI 开启下，会在例如 URL 为[`www.xxx.com/xx.jpg/.php`](http://www.xxx.com/xx.jpg/.php)中将 xx.jpg 当成 php 解析

Nginx 解析漏洞

在 Nginx0.5，0.6 以及 0.7 ⇐ 0.7.65，0.8 ⇐ 0.8.37 上存在空字节代码执行漏洞

也就是在访问如以下[`www.xxx.com/xx.jpg%00.php`](http://www.xxx.com/xx.jpg%00.php)中会将 xx.jpg 当作 php 文件解析
它将.jpg%00 看成一段字符

在 CVE-2013-4547 Nginx 下
还存在着将如下 URL [`www.xx.com/a.jpg%00`](http://www.xx.com/a.jpg%00)\0.php 中的 a.jpg 当作 php 执行漏洞

发表于 2020-08-05 19:16:18

* * *

[“读你”](https://www.nowcoder.com/profile/7333168)

Apache 解析漏洞，支持的后缀为“php”，并且在解析时是按照从右到左执行，如 12345.php.owf.rar,Apache 在解析时从右往左，解析成 12345.php 便解析完成，而攻击者可以把木马文件放在其中。IIS 解析漏洞，该网站下建立的文件夹名称后缀为.asp,.asa,其目录下的任何文件都被 IIS 当做 asp 文件来解析。 发表于 2021-03-01 14:58:26

* * *

[牛客 935006236 号](https://www.nowcoder.com/profile/935006236)

apache        从右向左依次解析后缀，直到遇到 php 才会解析成功 IIS5.X/6.0    网站下建立文件夹的名字为.asp、.asa 的文件夹，其目录内的任何扩展名的文件都被 IIS 当作 asp 文件来解析并执行。  ；号后不解析；还可解析.asa、.cer、.cdx 文件    IIS7.0/7.5 将.jpg 当作.php 解析
ngix     将.jpg 当作.php 文件解析

发表于 2020-08-25 16:15:32

* * *

## 4

从哪些方面可以进行 CSRF 漏洞防御？

你的答案

本题知识点

安全工程师 深信服

讨论

[Papillon-debug](https://www.nowcoder.com/profile/964364078)

5.对敏感的请求增加安全的 token，可以通过自定义 http 首部字段实现。

发表于 2020-05-26 16:48:21

* * *

[牛客 935006236 号](https://www.nowcoder.com/profile/935006236)

在请求地址中添加 token 并验证; 验证 http referer 字段；在 http 头中自定义属性并验证，加验证码，浏览器 cookie 策略，尽量使用 POST，限制使用 GET。

发表于 2020-08-25 16:32:28

* * *